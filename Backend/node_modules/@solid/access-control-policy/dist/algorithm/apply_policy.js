"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.applyPolicy = void 0;
const match_1 = require("./match");
/**
 * # The apply policy algorithm
 *
 * A policy is applied if:
 * - At least one matcher it uses matches the given context; and
 * - All the conditions it defines are satisfied.
 *
 * Policy conditions behave like intersection, union and exclusion operators. In
 * order to be satisfied:
 * - allOf requires all of its matchers to match the given context;
 * - anyOf requires one of its matchers to match the given context;
 * - noneOf requires none of its matchers to match the given context.
 *
 * Note: Given that the noneOf condition excludes matches, a policy without a
 * satisfied allOf or anyOf condition never applies.
 *
 * @param policy The policy to evaluate
 * @param context The context in which the policy is evaluated
 * @returns True if the policy applies, false otherwise
 */
function applyPolicy(policy, context) {
    if (policy.allOf.length + policy.anyOf.length > 0) {
        return ((policy.allOf.length === 0 ||
            policy.allOf.every((matcher) => (0, match_1.match)(matcher, context))) &&
            (policy.anyOf.length === 0 ||
                policy.anyOf.some((matcher) => (0, match_1.match)(matcher, context))) &&
            (policy.noneOf.length === 0 ||
                !policy.noneOf.some((matcher) => (0, match_1.match)(matcher, context))));
    }
    return false;
}
exports.applyPolicy = applyPolicy;
//# sourceMappingURL=apply_policy.js.map