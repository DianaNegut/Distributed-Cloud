{"version":3,"file":"apply_policy.js","sourceRoot":"","sources":["../../src/algorithm/apply_policy.ts"],"names":[],"mappings":";;;AAEA,mCAAgC;AAEhC;;;;;;;;;;;;;;;;;;;GAmBG;AACH,SAAgB,WAAW,CAAC,MAAe,EAAE,OAAiB;IAC5D,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QACjD,OAAO,CACL,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC;YACxB,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAA,aAAK,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;YAC3D,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC;gBACxB,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAA,aAAK,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;YAC1D,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC;gBACzB,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAA,aAAK,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAC7D,CAAC;KACH;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAZD,kCAYC","sourcesContent":["import type { IContext } from \"../type/i_context\";\nimport type { IPolicy } from \"../type/i_policy\";\nimport { match } from \"./match\";\n\n/**\n * # The apply policy algorithm\n *\n * A policy is applied if:\n * - At least one matcher it uses matches the given context; and\n * - All the conditions it defines are satisfied.\n *\n * Policy conditions behave like intersection, union and exclusion operators. In\n * order to be satisfied:\n * - allOf requires all of its matchers to match the given context;\n * - anyOf requires one of its matchers to match the given context;\n * - noneOf requires none of its matchers to match the given context.\n *\n * Note: Given that the noneOf condition excludes matches, a policy without a\n * satisfied allOf or anyOf condition never applies.\n *\n * @param policy The policy to evaluate\n * @param context The context in which the policy is evaluated\n * @returns True if the policy applies, false otherwise\n */\nexport function applyPolicy(policy: IPolicy, context: IContext): boolean {\n  if (policy.allOf.length + policy.anyOf.length > 0) {\n    return (\n      (policy.allOf.length === 0 ||\n        policy.allOf.every((matcher) => match(matcher, context))) &&\n      (policy.anyOf.length === 0 ||\n        policy.anyOf.some((matcher) => match(matcher, context))) &&\n      (policy.noneOf.length === 0 ||\n        !policy.noneOf.some((matcher) => match(matcher, context)))\n    );\n  }\n  return false;\n}\n"]}