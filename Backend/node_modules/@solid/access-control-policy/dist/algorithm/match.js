"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.match = void 0;
const match_agent_1 = require("./match_agent");
const match_client_1 = require("./match_client");
const match_issuer_1 = require("./match_issuer");
const match_vc_1 = require("./match_vc");
/**
 * The match algorithm
 *
 * The context matches if:
 * - At least one matching attribute is defined; and
 * - Every defined attribute matches the context.
 *
 * @param matcher The matcher to evaluate
 * @param context The context in which the matcher is evaluated
 * @returns True if the context matches, false otherwise
 */
function match(matcher, context) {
    if (matcher.agent.length +
        matcher.client.length +
        matcher.issuer.length +
        matcher.vc.length >
        0) {
        return ((matcher.agent.length === 0 || (0, match_agent_1.matchAgent)(matcher, context)) &&
            (matcher.client.length === 0 || (0, match_client_1.matchClient)(matcher, context)) &&
            (matcher.issuer.length === 0 || (0, match_issuer_1.matchIssuer)(matcher, context)) &&
            (matcher.vc.length === 0 || (0, match_vc_1.matchVc)(matcher, context)));
    }
    return false;
}
exports.match = match;
//# sourceMappingURL=match.js.map