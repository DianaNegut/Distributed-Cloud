{"version":3,"file":"match_agent.js","sourceRoot":"","sources":["../../src/algorithm/match_agent.ts"],"names":[],"mappings":";;;AAAA,yCAAsC;AAItC;;;;;;;;;;;;;;;GAeG;AACH,SAAgB,UAAU,CAAC,OAAiB,EAAE,OAAiB;IAC7D,gDAAgD;IAChD,IACE,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,aAAa,EAAE,EAAE;QACnC,6CAA6C;QAC7C,IAAI,aAAa,KAAK,SAAG,CAAC,WAAW,EAAE;YACrC,OAAO,IAAI,CAAC;SACb;QACD,kCAAkC;QAClC,IAAI,OAAO,CAAC,KAAK,EAAE;YACjB,6CAA6C;YAC7C,IAAI,aAAa,KAAK,OAAO,CAAC,KAAK,EAAE;gBACnC,OAAO,IAAI,CAAC;aACb;YACD,+DAA+D;YAC/D,IAAI,aAAa,KAAK,SAAG,CAAC,kBAAkB,EAAE;gBAC5C,OAAO,IAAI,CAAC;aACb;YACD,kEAAkE;YAClE,IAAI,aAAa,KAAK,SAAG,CAAC,YAAY,EAAE;gBACtC,OAAO,OAAO,CAAC,OAAO,EAAE,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aACjD;YACD,8DAA8D;YAC9D,IAAI,aAAa,KAAK,SAAG,CAAC,UAAU,EAAE;gBACpC,OAAO,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aAC/C;SACF;QACD,8CAA8C;QAC9C,OAAO,KAAK,CAAC;IACf,CAAC,CAAC,EACF;QACA,OAAO,IAAI,CAAC;KACb;IACD,0BAA0B;IAC1B,OAAO,KAAK,CAAC;AACf,CAAC;AAnCD,gCAmCC","sourcesContent":["import { ACP } from \"../constant/acp\";\nimport type { IContext } from \"../type/i_context\";\nimport type { IMatcher } from \"../type/i_matcher\";\n\n/**\n * # The agent matching algorithm\n *\n * The context agent should be an IRI identifying the agent by virtue of the agent having proven he controls the IRI. For example, this IRI could be a WebID as defined by the WebID specification and over which control has been asserted as defined in the Solid OIDC specification.\n *\n * The context matches if the matcher agent attribute contains:\n * - The defined context agent; or\n * - The ACP Public Agent; or\n * - The ACP Authenticated Agent and the given context agent is defined; or\n * - The ACP Creator Agent and the context creators include the agent; or\n * - The ACP Owner Agent and the context owners include the agent.\n *\n * @param matcher The matcher to evaluate\n * @param context The context in which the matcher is evaluated\n * @returns True if there is a match, false otherwise\n */\nexport function matchAgent(matcher: IMatcher, context: IContext): boolean {\n  // If at least one agent IRI matches return true\n  if (\n    matcher.agent.some((matchingAgent) => {\n      // The ACP Public Agent matches every context\n      if (matchingAgent === ACP.PublicAgent) {\n        return true;\n      }\n      // If the context agent is defined\n      if (context.agent) {\n        // The context agent matches a matching agent\n        if (matchingAgent === context.agent) {\n          return true;\n        }\n        // The ACP AuthenticatedAgent matches any defined context agent\n        if (matchingAgent === ACP.AuthenticatedAgent) {\n          return true;\n        }\n        // The ACP Creator Agent matches context agent and context creator\n        if (matchingAgent === ACP.CreatorAgent) {\n          return context.creator?.includes(context.agent);\n        }\n        // The ACP Owner Agent matches context agent and context owner\n        if (matchingAgent === ACP.OwnerAgent) {\n          return context.owner?.includes(context.agent);\n        }\n      }\n      // Otherwise, the matching agent doesn't match\n      return false;\n    })\n  ) {\n    return true;\n  }\n  // Otherwise, return false\n  return false;\n}\n"]}