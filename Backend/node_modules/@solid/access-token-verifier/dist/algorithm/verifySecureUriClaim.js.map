{"version":3,"file":"verifySecureUriClaim.js","sourceRoot":"","sources":["../../src/algorithm/verifySecureUriClaim.ts"],"names":[],"mappings":";;;AAAA,8FAA2F;AAE3F;;;;;;;GAOG;AACH,SAAgB,oBAAoB,CAAC,GAAW,EAAE,KAAa;IAC7D,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;IACzB,IACE,GAAG,CAAC,QAAQ,KAAK,QAAQ;QACzB,CAAC,CAAC,GAAG,CAAC,QAAQ,KAAK,OAAO,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,KAAK,WAAW,CAAC,EAC5E;QACA,MAAM,IAAI,iEAA+B,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;KACvD;AACH,CAAC;AARD,oDAQC","sourcesContent":["import { SecureUriClaimVerificationError } from \"../error/SecureUriClaimVerificationError\";\n\n/**\n * Verifies a URI claim is secured over TLS\n *\n * Currently restricts to HTTPS URIs and localhost.\n * TODO: Check if we can restrict to HTTP over TLS if/when in the future it is allowed or allow other protocols\n *\n * See also: https://solid.github.io/solid-oidc/#security-tls & https://github.com/solid/authentication-panel/issues/114#issuecomment-751867437\n */\nexport function verifySecureUriClaim(uri: string, claim: string): void {\n  const url = new URL(uri);\n  if (\n    url.protocol !== \"https:\" &&\n    !(url.protocol === \"http:\" && url.hostname.split(\".\").pop() === \"localhost\")\n  ) {\n    throw new SecureUriClaimVerificationError(uri, claim);\n  }\n}\n"]}