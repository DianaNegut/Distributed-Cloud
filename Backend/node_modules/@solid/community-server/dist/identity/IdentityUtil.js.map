{"version":3,"file":"IdentityUtil.js","sourceRoot":"","sources":["../../src/identity/IdentityUtil.ts"],"names":[],"mappings":";;AAYA,gDAKC;AAfD;;;;;;;;;GASG;AACH,SAAgB,kBAAkB;IAChC,IAAI,OAAO,CAAC,GAAG,CAAC,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,MAAM,EAAE,CAAC;QAClE,OAAO,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;IAC7C,CAAC;IACD,OAAO,MAAM,CAAC,eAAe,CAAC,CAAC;AACjC,CAAC","sourcesContent":["import type { CanBePromise } from '../../templates/types/oidc-provider';\n\n/**\n * Import the OIDC-provider package.\n *\n * As oidc-provider is an ESM package and CSS is CJS, we have to use a dynamic import here.\n * Unfortunately, there is a Node/Jest bug that causes segmentation faults when doing such an import in Jest:\n * https://github.com/nodejs/node/issues/35889\n * To work around that, we do the import differently, in case we are in a Jest test run.\n * This can be detected via the env variables: https://jestjs.io/docs/environment-variables.\n * There have been reports of `JEST_WORKER_ID` being undefined, so to be sure we check both.\n */\nexport function importOidcProvider(): CanBePromise<typeof import('../../templates/types/oidc-provider')> {\n  if (process.env.JEST_WORKER_ID ?? process.env.NODE_ENV === 'test') {\n    return jest.requireActual('oidc-provider');\n  }\n  return import('oidc-provider');\n}\n"]}