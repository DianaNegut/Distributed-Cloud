{"version":3,"file":"ViewInteractionHandler.js","sourceRoot":"","sources":["../../../src/identity/interaction/ViewInteractionHandler.ts"],"names":[],"mappings":";;;AAAA,2FAAwF;AAGxF,qEAAkE;AAGlE;;;;;;;GAOG;AACH,MAAa,sBAAuB,SAAQ,+CAAsB;IAC/C,MAAM,CAAoC;IAE3D,YAAmB,MAAyC;QAC1D,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAEM,KAAK,CAAC,SAAS,CAAC,KAAkC;QACvD,MAAM,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;QACzB,IAAI,MAAM,KAAK,KAAK,IAAI,MAAM,KAAK,MAAM,EAAE,CAAC;YAC1C,MAAM,IAAI,qDAAyB,CAAC,CAAE,MAAM,CAAE,EAAE,uCAAuC,CAAC,CAAC;QAC3F,CAAC;QAED,IAAI,MAAM,KAAK,MAAM,EAAE,CAAC;YACtB,MAAM,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC;IACH,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,KAAkC;QACpD,IAAI,KAAK,CAAC,MAAM,KAAK,KAAK,EAAE,CAAC;YAC3B,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACpC,CAAC;QACD,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC;CACF;AAzBD,wDAyBC","sourcesContent":["import { MethodNotAllowedHttpError } from '../../util/errors/MethodNotAllowedHttpError';\nimport type { JsonRepresentation } from './InteractionUtil';\nimport type { JsonInteractionHandlerInput } from './JsonInteractionHandler';\nimport { JsonInteractionHandler } from './JsonInteractionHandler';\nimport type { JsonView } from './JsonView';\n\n/**\n * Utility class for the common case of a {@link JsonInteractionHandler}\n * describing the expected input on a GET request which is needed to do a POST request.\n *\n * Returns the result of a {@link JsonView} on GET requests.\n * POST requests are sent to the {@link JsonInteractionHandler}.\n * Other methods will be rejected.\n */\nexport class ViewInteractionHandler extends JsonInteractionHandler {\n  private readonly source: JsonInteractionHandler & JsonView;\n\n  public constructor(source: JsonInteractionHandler & JsonView) {\n    super();\n    this.source = source;\n  }\n\n  public async canHandle(input: JsonInteractionHandlerInput): Promise<void> {\n    const { method } = input;\n    if (method !== 'GET' && method !== 'POST') {\n      throw new MethodNotAllowedHttpError([ method ], 'Only GET/POST requests are supported.');\n    }\n\n    if (method === 'POST') {\n      await this.source.canHandle(input);\n    }\n  }\n\n  public async handle(input: JsonInteractionHandlerInput): Promise<JsonRepresentation> {\n    if (input.method === 'GET') {\n      return this.source.getView(input);\n    }\n    return this.source.handle(input);\n  }\n}\n"]}