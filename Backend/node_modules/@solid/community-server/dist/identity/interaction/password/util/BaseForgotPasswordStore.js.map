{"version":3,"file":"BaseForgotPasswordStore.js","sourceRoot":"","sources":["../../../../../src/identity/interaction/password/util/BaseForgotPasswordStore.ts"],"names":[],"mappings":";;;AAAA,+BAA0B;AAI1B;;GAEG;AACH,MAAa,uBAAuB;IACjB,OAAO,CAAkC;IACzC,GAAG,CAAS;IAE7B,YAAmB,OAAwC,EAAE,GAAG,GAAG,EAAE;QACnE,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC;IAC7B,CAAC;IAEM,KAAK,CAAC,QAAQ,CAAC,KAAa;QACjC,MAAM,QAAQ,GAAG,IAAA,SAAE,GAAE,CAAC;QACtB,MAAM,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;QAClD,OAAO,QAAQ,CAAC;IAClB,CAAC;IAEM,KAAK,CAAC,GAAG,CAAC,QAAgB;QAC/B,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,QAAgB;QAClC,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACvC,CAAC;CACF;AAtBD,0DAsBC","sourcesContent":["import { v4 } from 'uuid';\nimport type { ExpiringStorage } from '../../../../storage/keyvalue/ExpiringStorage';\nimport type { ForgotPasswordStore } from './ForgotPasswordStore';\n\n/**\n * A {@link ForgotPasswordStore} using an {@link ExpiringStorage} to hold the necessary records.\n */\nexport class BaseForgotPasswordStore implements ForgotPasswordStore {\n  private readonly storage: ExpiringStorage<string, string>;\n  private readonly ttl: number;\n\n  public constructor(storage: ExpiringStorage<string, string>, ttl = 15) {\n    this.storage = storage;\n    this.ttl = ttl * 60 * 1000;\n  }\n\n  public async generate(email: string): Promise<string> {\n    const recordId = v4();\n    await this.storage.set(recordId, email, this.ttl);\n    return recordId;\n  }\n\n  public async get(recordId: string): Promise<string | undefined> {\n    return this.storage.get(recordId);\n  }\n\n  public async delete(recordId: string): Promise<boolean> {\n    return this.storage.delete(recordId);\n  }\n}\n"]}