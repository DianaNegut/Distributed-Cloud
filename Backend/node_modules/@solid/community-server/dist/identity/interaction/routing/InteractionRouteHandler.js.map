{"version":3,"file":"InteractionRouteHandler.js","sourceRoot":"","sources":["../../../../src/identity/interaction/routing/InteractionRouteHandler.ts"],"names":[],"mappings":";;;AAAA,8EAA2E;AAG3E,sEAAmE;AAGnE;;;;;GAKG;AACH,MAAa,uBAA4D,SAAQ,+CAAsB;IAClF,KAAK,CAAI;IACT,MAAM,CAAyB;IAElD,YAAmB,KAAQ,EAAE,MAA8B;QACzD,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAEM,KAAK,CAAC,SAAS,CAAC,KAAkC;QACvD,MAAM,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;QAEzB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;YACvC,MAAM,IAAI,qCAAiB,EAAE,CAAC;QAChC,CAAC;QACD,MAAM,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACrC,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,KAAkC;QACpD,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC;CACF;AAtBD,0DAsBC","sourcesContent":["import { NotFoundHttpError } from '../../../util/errors/NotFoundHttpError';\nimport type { JsonRepresentation } from '../InteractionUtil';\nimport type { JsonInteractionHandlerInput } from '../JsonInteractionHandler';\nimport { JsonInteractionHandler } from '../JsonInteractionHandler';\nimport type { InteractionRoute } from './InteractionRoute';\n\n/**\n * InteractionHandler that only accepts input of which the target matches the stored route.\n *\n * Rejects operations that target a different route,\n * otherwise the input parameters are passed to the source handler.\n */\nexport class InteractionRouteHandler<T extends InteractionRoute<string>> extends JsonInteractionHandler {\n  protected readonly route: T;\n  protected readonly source: JsonInteractionHandler;\n\n  public constructor(route: T, source: JsonInteractionHandler) {\n    super();\n    this.route = route;\n    this.source = source;\n  }\n\n  public async canHandle(input: JsonInteractionHandlerInput): Promise<void> {\n    const { target } = input;\n\n    if (!this.route.matchPath(target.path)) {\n      throw new NotFoundHttpError();\n    }\n    await this.source.canHandle(input);\n  }\n\n  public async handle(input: JsonInteractionHandlerInput): Promise<JsonRepresentation> {\n    return this.source.handle(input);\n  }\n}\n"]}