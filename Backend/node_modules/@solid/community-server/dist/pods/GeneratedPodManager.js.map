{"version":3,"file":"GeneratedPodManager.js","sourceRoot":"","sources":["../../src/pods/GeneratedPodManager.ts"],"names":[],"mappings":";;;AAAA,gDAAkD;AAElD,wEAAqE;AACrE,0DAAgE;AAKhE;;;GAGG;AACH,MAAa,mBAAmB;IACX,MAAM,GAAG,IAAA,sBAAY,EAAC,IAAI,CAAC,CAAC;IAE9B,KAAK,CAAgB;IACrB,kBAAkB,CAAqB;IAExD,YAAmB,KAAoB,EAAE,kBAAsC;QAC7E,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;IAC/C,CAAC;IAED;;;OAGG;IACI,KAAK,CAAC,SAAS,CAAC,QAAqB,EAAE,SAAkB;QAC9D,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;QACvD,IAAI,CAAC,SAAS,IAAI,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;YAC9D,MAAM,IAAI,qCAAiB,CAAC,kCAAkC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;QACtF,CAAC;QAED,MAAM,KAAK,GAAG,MAAM,IAAA,oCAAqB,EAAC,QAAQ,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACzF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,KAAK,iBAAiB,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IACxE,CAAC;CACF;AAxBD,kDAwBC","sourcesContent":["import { getLoggerFor } from '../logging/LogUtil';\nimport type { ResourceStore } from '../storage/ResourceStore';\nimport { ConflictHttpError } from '../util/errors/ConflictHttpError';\nimport { addGeneratedResources } from './generate/GenerateUtil';\nimport type { ResourcesGenerator } from './generate/ResourcesGenerator';\nimport type { PodManager } from './PodManager';\nimport type { PodSettings } from './settings/PodSettings';\n\n/**\n * Pod manager that uses an {@link IdentifierGenerator} and {@link ResourcesGenerator}\n * to create the default resources and identifier for a new pod.\n */\nexport class GeneratedPodManager implements PodManager {\n  protected readonly logger = getLoggerFor(this);\n\n  private readonly store: ResourceStore;\n  private readonly resourcesGenerator: ResourcesGenerator;\n\n  public constructor(store: ResourceStore, resourcesGenerator: ResourcesGenerator) {\n    this.store = store;\n    this.resourcesGenerator = resourcesGenerator;\n  }\n\n  /**\n   * Creates a new pod, pre-populating it with the resources created by the data generator.\n   * Will throw an error if the given identifier already has a resource.\n   */\n  public async createPod(settings: PodSettings, overwrite: boolean): Promise<void> {\n    this.logger.info(`Creating pod ${settings.base.path}`);\n    if (!overwrite && await this.store.hasResource(settings.base)) {\n      throw new ConflictHttpError(`There already is a resource at ${settings.base.path}`);\n    }\n\n    const count = await addGeneratedResources(settings, this.resourcesGenerator, this.store);\n    this.logger.info(`Added ${count} resources to ${settings.base.path}`);\n  }\n}\n"]}