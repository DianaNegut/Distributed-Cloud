{"version":3,"file":"NotificationChannelType.js","sourceRoot":"","sources":["../../../src/server/notifications/NotificationChannelType.ts"],"names":[],"mappings":"","sourcesContent":["import type { Store } from 'n3';\nimport type { Credentials } from '../../authentication/Credentials';\nimport type { AccessMap } from '../../authorization/permissions/Permissions';\nimport type { CONTEXT_NOTIFICATION } from './Notification';\nimport type { NotificationChannel } from './NotificationChannel';\n\n/**\n * A subscription service description as based on the specification data model\n * https://solidproject.org/TR/2022/notifications-protocol-20221231#subscription-service-data-model\n */\nexport interface SubscriptionService {\n  // eslint-disable-next-line ts/naming-convention\n  '@context': [ typeof CONTEXT_NOTIFICATION ];\n  id: string;\n  channelType: string;\n  feature: string[];\n}\n\n/**\n * A specific channel type as defined at\n * https://solidproject.org/TR/2022/notifications-protocol-20221231#notification-channel-types.\n *\n * All functions that take a {@link NotificationChannel} as input\n * only need to support channels generated by an `initChannel` on the same class.\n */\nexport interface NotificationChannelType {\n  /**\n   * Returns the {@link SubscriptionService} that describes how to subscribe to this channel type.\n   */\n  getDescription: () => SubscriptionService;\n\n  /**\n   * Validate and convert the input quads into a {@link NotificationChannel}.\n   *\n   * @param data - The input quads.\n   * @param credentials - The credentials of the agent doing the request.\n   */\n  initChannel: (data: Store, credentials: Credentials) => Promise<NotificationChannel>;\n\n  /**\n   * Converts a {@link NotificationChannel} to a serialized JSON-LD representation.\n   *\n   * @param channel - The notification channel to serialize.\n   */\n  toJsonLd: (channel: NotificationChannel) => Promise<Record<string, unknown>>;\n\n  /**\n   * Determines which modes are required to allow the given notification channel.\n   *\n   * @param channel - The notification channel to verify.\n   *\n   * @returns The required modes.\n   */\n  extractModes: (channel: NotificationChannel) => Promise<AccessMap>;\n\n  /**\n   * This function will be called after the serialized channel is sent back as a response,\n   * allowing for any final actions that need to happen.\n   *\n   * @param channel - The notification channel that is completed.\n   */\n  completeChannel: (channel: NotificationChannel) => Promise<void>;\n}\n"]}