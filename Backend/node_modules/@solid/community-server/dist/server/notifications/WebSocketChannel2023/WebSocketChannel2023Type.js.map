{"version":3,"file":"WebSocketChannel2023Type.js","sourceRoot":"","sources":["../../../../src/server/notifications/WebSocketChannel2023/WebSocketChannel2023Type.ts"],"names":[],"mappings":";;;AAuBA,wDAEC;AAtBD,sDAAwD;AACxD,6DAAoD;AACpD,wDAAqD;AAErD,2DAA2D;AAgB3D,SAAgB,sBAAsB,CAAC,OAA4B;IACjE,OAAO,OAAO,CAAC,IAAI,KAAK,qBAAM,CAAC,oBAAoB,CAAC;AACtD,CAAC;AAED;;;;;GAKG;AACH,MAAa,wBAAyB,SAAQ,iCAAe;IACxC,MAAM,GAAG,IAAA,sBAAY,EAAC,IAAI,CAAC,CAAC;IAE/C,YAAmB,KAAuB,EAAE,QAAmB;QAC7D,KAAK,CAAC,qBAAM,CAAC,KAAK,CAAC,oBAAoB,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC5D,CAAC;IAEM,KAAK,CAAC,WAAW,CAAC,IAAW,EAAE,WAAwB;QAC5D,MAAM,OAAO,GAAG,MAAM,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC3D,OAAO;YACL,GAAG,OAAO;YACV,IAAI,EAAE,qBAAM,CAAC,oBAAoB;YACjC,WAAW,EAAE,IAAA,wCAAoB,EAAC,OAAO,CAAC,EAAE,CAAC;SAC9C,CAAC;IACJ,CAAC;CACF;AAfD,4DAeC","sourcesContent":["import type { Store } from 'n3';\nimport type { Credentials } from '../../../authentication/Credentials';\nimport type { InteractionRoute } from '../../../identity/interaction/routing/InteractionRoute';\nimport { getLoggerFor } from '../../../logging/LogUtil';\nimport { NOTIFY } from '../../../util/Vocabularies';\nimport { BaseChannelType } from '../BaseChannelType';\nimport type { NotificationChannel } from '../NotificationChannel';\nimport { generateWebSocketUrl } from './WebSocket2023Util';\n\n/**\n * A {@link NotificationChannel} containing the necessary fields for a WebSocketChannel2023 channel.\n */\nexport interface WebSocketChannel2023 extends NotificationChannel {\n  /**\n   * The \"notify:WebSocketChannel2023\" type.\n   */\n  type: typeof NOTIFY.WebSocketChannel2023;\n  /**\n   * The WebSocket through which the channel will send notifications.\n   */\n  receiveFrom: string;\n}\n\nexport function isWebSocket2023Channel(channel: NotificationChannel): channel is WebSocketChannel2023 {\n  return channel.type === NOTIFY.WebSocketChannel2023;\n}\n\n/**\n * The notification channel type WebSocketChannel2023 as described in\n * https://solid.github.io/notifications/websocket-channel-2023\n *\n * Requires read permissions on a resource to be able to receive notifications.\n */\nexport class WebSocketChannel2023Type extends BaseChannelType {\n  protected readonly logger = getLoggerFor(this);\n\n  public constructor(route: InteractionRoute, features?: string[]) {\n    super(NOTIFY.terms.WebSocketChannel2023, route, features);\n  }\n\n  public async initChannel(data: Store, credentials: Credentials): Promise<WebSocketChannel2023> {\n    const channel = await super.initChannel(data, credentials);\n    return {\n      ...channel,\n      type: NOTIFY.WebSocketChannel2023,\n      receiveFrom: generateWebSocketUrl(channel.id),\n    };\n  }\n}\n"]}