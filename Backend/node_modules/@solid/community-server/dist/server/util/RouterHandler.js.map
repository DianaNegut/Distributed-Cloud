{"version":3,"file":"RouterHandler.js","sourceRoot":"","sources":["../../../src/server/util/RouterHandler.ts"],"names":[],"mappings":";;;AACA,+EAA4E;AAE5E,2DAAwD;AAOxD;;;GAGG;AACH,MAAa,aAAc,SAAQ,qCAA8B;IAC9C,eAAe,CAAkB;IAElD,YAAmB,IAAuB;QACxC,KAAK,CAAC,IAAI,CAAC,CAAC;QACZ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;IAC9C,CAAC;IAEM,KAAK,CAAC,SAAS,CAAC,KAAuB;QAC5C,MAAM,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;QAC1B,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;YACjB,MAAM,IAAI,yCAAmB,CAAC,qCAAqC,CAAC,CAAC;QACvE,CAAC;QACD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC;QAClE,MAAM,KAAK,CAAC,cAAc,CAAC,KAAK,EAAE,OAAO,CAAC,MAAM,IAAI,SAAS,EAAE,MAAM,CAAC,CAAC;IACzE,CAAC;CACF;AAhBD,sCAgBC","sourcesContent":["import type { TargetExtractor } from '../../http/input/identifier/TargetExtractor';\nimport { BadRequestHttpError } from '../../util/errors/BadRequestHttpError';\nimport type { HttpHandler, HttpHandlerInput } from '../HttpHandler';\nimport { BaseRouterHandler } from './BaseRouterHandler';\nimport type { BaseRouterHandlerArgs } from './BaseRouterHandler';\n\nexport interface RouterHandlerArgs extends BaseRouterHandlerArgs<HttpHandler> {\n  targetExtractor: TargetExtractor;\n}\n\n/**\n * A {@link BaseRouterHandler} for an {@link HttpHandler}.\n * Uses a {@link TargetExtractor} to generate the target identifier.\n */\nexport class RouterHandler extends BaseRouterHandler<HttpHandler> {\n  private readonly targetExtractor: TargetExtractor;\n\n  public constructor(args: RouterHandlerArgs) {\n    super(args);\n    this.targetExtractor = args.targetExtractor;\n  }\n\n  public async canHandle(input: HttpHandlerInput): Promise<void> {\n    const { request } = input;\n    if (!request.url) {\n      throw new BadRequestHttpError('Cannot handle request without a url');\n    }\n    const target = await this.targetExtractor.handleSafe({ request });\n    await super.canHandleInput(input, request.method ?? 'UNKNOWN', target);\n  }\n}\n"]}